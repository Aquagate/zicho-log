<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>zicho-log v0.1</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <h1>体調グチログ v0.1</h1>
      <nav class="app-nav">
        <button type="button" class="nav-button" data-target="home">入力</button>
        <button type="button" class="nav-button" data-target="list">一覧</button>
        <button type="button" class="nav-button" data-target="llm">LLM素材</button>
        <button type="button" class="nav-button" data-target="llm-output">LLM返答</button>
        <button type="button" class="nav-button" data-target="export">エクスポート</button>
      </nav>
    </header>

    <main class="app-main">
      <section id="home" class="app-section is-active">
        <h2>ログ入力</h2>
        <form id="log-form" class="card">
          <div class="form-row">
            <label for="entry-date">日付</label>
            <input type="date" id="entry-date" name="entry-date" required />
          </div>
          <div class="form-row">
            <label for="complaint-text">今日の愚痴・自嘲（必須）</label>
            <textarea id="complaint-text" name="complaint-text" rows="3" required placeholder="1〜3行でOK"></textarea>
          </div>
          <div class="form-row">
            <label for="fact-text">事実 or 小さな肯定（任意だけど書くと良い）</label>
            <input type="text" id="fact-text" name="fact-text" placeholder="例: 5分散歩できた" />
          </div>
          <div class="form-grid">
            <div>
              <label for="pain-low">腰痛 (0-10)</label>
              <input type="range" id="pain-low" name="pain-low" min="0" max="10" step="1" />
              <div class="range-value" id="pain-low-value">0</div>
            </div>
            <div>
              <label for="pain-hip">股関節痛 (0-10)</label>
              <input type="range" id="pain-hip" name="pain-hip" min="0" max="10" step="1" />
              <div class="range-value" id="pain-hip-value">0</div>
            </div>
            <div>
              <label for="sleep-hours">睡眠時間 (h)</label>
              <input type="number" id="sleep-hours" name="sleep-hours" min="0" max="24" step="0.5" placeholder="例: 6.5" />
            </div>
            <div>
              <label for="sleep-quality">睡眠質</label>
              <select id="sleep-quality" name="sleep-quality">
                <option value="">選択なし</option>
                <option value="good">good</option>
                <option value="ok">ok</option>
                <option value="bad">bad</option>
              </select>
            </div>
            <div>
              <label for="mental-state">メンタル</label>
              <select id="mental-state" name="mental-state">
                <option value="">選択なし</option>
                <option value="good">good</option>
                <option value="ok">ok</option>
                <option value="bad">bad</option>
              </select>
            </div>
            <div>
              <label for="activity-hint">活動メモ（任意）</label>
              <input type="text" id="activity-hint" name="activity-hint" placeholder="例: 在宅作業" />
            </div>
          </div>
          <div class="form-actions">
            <button type="submit" class="primary">保存</button>
            <span class="form-hint">最短で保存できます。数値は後から編集OK。</span>
          </div>
        </form>
      </section>

      <section id="list" class="app-section">
        <h2>ログ一覧</h2>
        <div class="card">
          <div class="filter-row">
            <span>期間</span>
            <button type="button" class="quick-range" data-range="7">直近7日</button>
            <button type="button" class="quick-range" data-range="30">直近30日</button>
            <label>From <input type="date" id="filter-from" /></label>
            <label>To <input type="date" id="filter-to" /></label>
          </div>
          <div class="filter-row">
            <label>腰痛 >= <input type="number" id="filter-low" min="0" max="10" step="1" /></label>
            <label>股関節痛 >= <input type="number" id="filter-hip" min="0" max="10" step="1" /></label>
            <button type="button" id="apply-filter">フィルタ適用</button>
          </div>
        </div>
        <div id="log-list" class="list"></div>
      </section>

      <section id="detail" class="app-section">
        <h2>ログ詳細 / 編集</h2>
        <form id="edit-form" class="card">
          <input type="hidden" id="edit-id" />
          <div class="form-row">
            <label for="edit-date">日付</label>
            <input type="date" id="edit-date" required />
          </div>
          <div class="form-row">
            <label for="edit-complaint">愚痴・自嘲</label>
            <textarea id="edit-complaint" rows="3" required></textarea>
          </div>
          <div class="form-row">
            <label for="edit-fact">事実 or 小さな肯定</label>
            <input type="text" id="edit-fact" />
          </div>
          <div class="form-grid">
            <div>
              <label for="edit-pain-low">腰痛 (0-10)</label>
              <input type="number" id="edit-pain-low" min="0" max="10" step="1" />
            </div>
            <div>
              <label for="edit-pain-hip">股関節痛 (0-10)</label>
              <input type="number" id="edit-pain-hip" min="0" max="10" step="1" />
            </div>
            <div>
              <label for="edit-sleep-hours">睡眠時間</label>
              <input type="number" id="edit-sleep-hours" min="0" max="24" step="0.5" />
            </div>
            <div>
              <label for="edit-sleep-quality">睡眠質</label>
              <select id="edit-sleep-quality">
                <option value="">選択なし</option>
                <option value="good">good</option>
                <option value="ok">ok</option>
                <option value="bad">bad</option>
              </select>
            </div>
            <div>
              <label for="edit-mental">メンタル</label>
              <select id="edit-mental">
                <option value="">選択なし</option>
                <option value="good">good</option>
                <option value="ok">ok</option>
                <option value="bad">bad</option>
              </select>
            </div>
            <div>
              <label for="edit-activity">活動メモ</label>
              <input type="text" id="edit-activity" />
            </div>
          </div>
          <div class="form-actions">
            <button type="submit" class="primary">更新</button>
            <button type="button" id="delete-log" class="danger">削除</button>
            <button type="button" id="back-to-list">一覧へ戻る</button>
          </div>
        </form>
      </section>

      <section id="llm" class="app-section">
        <h2>LLMコピペ素材生成</h2>
        <div class="card">
          <div class="filter-row">
            <span>対象期間</span>
            <button type="button" class="quick-llm" data-range="7">直近7日</button>
            <button type="button" class="quick-llm" data-range="30">直近30日</button>
            <label>From <input type="date" id="llm-from" /></label>
            <label>To <input type="date" id="llm-to" /></label>
            <button type="button" id="generate-llm">生成</button>
          </div>
          <div class="form-row">
            <label for="llm-output-text">生成結果</label>
            <textarea id="llm-output-text" rows="14" readonly></textarea>
          </div>
          <div class="form-actions">
            <button type="button" id="copy-llm" class="primary">コピー</button>
            <span id="copy-status" class="form-hint"></span>
          </div>
        </div>
      </section>

      <section id="llm-output" class="app-section">
        <h2>LLM返答取り込み</h2>
        <div class="card">
          <div class="filter-row">
            <span>対象期間</span>
            <button type="button" class="quick-llm-output" data-range="7">直近7日</button>
            <button type="button" class="quick-llm-output" data-range="30">直近30日</button>
            <label>From <input type="date" id="output-from" /></label>
            <label>To <input type="date" id="output-to" /></label>
          </div>
          <div class="form-row">
            <label for="model-info">モデル情報（任意）</label>
            <input type="text" id="model-info" placeholder="例: GPT-4o" />
          </div>
          <div class="form-row">
            <label for="raw-output">LLM返答（貼り付け）</label>
            <textarea id="raw-output" rows="10" placeholder="1) ... 〜 6) ... を貼り付け"></textarea>
          </div>
          <div class="form-actions">
            <button type="button" id="save-llm-output" class="primary">保存</button>
            <span id="parse-status" class="form-hint"></span>
          </div>
        </div>
        <div id="llm-output-list" class="list"></div>
      </section>

      <section id="export" class="app-section">
        <h2>設定 / エクスポート</h2>
        <div class="card">
          <p>全ログとLLMOutputを単一JSONとしてダウンロードできます。</p>
          <div class="filter-row">
            <span>期間指定 (任意)</span>
            <label>From <input type="date" id="export-from" /></label>
            <label>To <input type="date" id="export-to" /></label>
          </div>
          <div class="form-actions">
            <button type="button" id="export-json" class="primary">JSONダウンロード</button>
          </div>
        </div>
      </section>
    </main>

    <div id="toast" class="toast"></div>
    <script src="app.js"></script>
  </body>
</html>
